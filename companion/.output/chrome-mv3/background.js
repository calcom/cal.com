var background=(function(){"use strict";var l,h;function m(e){return e==null||typeof e=="function"?{main:e}:e}const y=m(()=>{chrome.action.onClicked.addListener(e=>{e.id&&chrome.tabs.sendMessage(e.id,{action:"icon-clicked"},t=>{chrome.runtime.lastError})}),chrome.runtime.onMessage.addListener((e,t,o)=>e.action==="fetch-event-types"?(g().then(n=>{o({data:n})}).catch(n=>{o({error:n.message})}),!0):!1)});async function g(){var e;try{const t="cal_live_290b9edb42293829bd24c155fe866562",o="https://api.cal.com/v2",n=await fetch(`${o}/me`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json","cal-api-version":"2024-06-11"}});if(!n.ok)throw new Error(`Failed to get user: ${n.statusText}`);const c=await n.json(),d=(e=c==null?void 0:c.data)==null?void 0:e.username,f=new URLSearchParams;d&&f.append("username",d);const p=f.toString(),b=`${o}/event-types${p?`?${p}`:""}`,u=await fetch(b,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json","cal-api-version":"2024-06-14"}});if(!u.ok)throw new Error(`Failed to fetch event types: ${u.statusText}`);const r=await u.json();let i=[];return Array.isArray(r)?i=r:r!=null&&r.data&&Array.isArray(r.data)?i=r.data:r!=null&&r.eventTypes&&Array.isArray(r.eventTypes)&&(i=r.eventTypes),i}catch(t){throw t}}function T(){}(h=(l=globalThis.browser)==null?void 0:l.runtime)!=null&&h.id?globalThis.browser:globalThis.chrome;function s(e,...t){}const w={debug:(...e)=>s(console.debug,...e),log:(...e)=>s(console.log,...e),warn:(...e)=>s(console.warn,...e),error:(...e)=>s(console.error,...e)};let a;try{a=y.main(),a instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw w.error("The background crashed on startup!"),e}return a})();
