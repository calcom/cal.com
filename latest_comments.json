[{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097770","pull_request_review_id":3693920404,"id":2718097770,"node_id":"PRRC_kwDOFOISeM6iAuFq","diff_hunk":"@@ -16,14 +16,16 @@ export const getAnalyticsService = async ({\n \n   const analyticsName = analyticsType.split(\"_\")[0];\n \n-  const analyticsAppImportFn = AnalyticsServiceMap[analyticsName as keyof typeof AnalyticsServiceMap];\n+  const analyticsAppGetter = AnalyticsServiceMap[analyticsName as keyof typeof AnalyticsServiceMap];\n \n-  if (!analyticsAppImportFn) {\n+  if (!analyticsAppGetter) {\n     log.warn(`analytics app not implemented`);\n     return null;\n   }\n \n-  const analyticsApp = await analyticsAppImportFn;\n+  const analyticsApp = await (typeof analyticsAppGetter === \"function\"","path":"packages/app-store/_utils/getAnalytics.ts","commit_id":"83b58b2a379325d838a5a4505e1c506b3ed36816","original_commit_id":"2f0d2afd01ea38b0a2ab110447002914bfb55832","user":{"login":"cubic-dev-ai[bot]","id":191113872,"node_id":"BOT_kgDOC2QqkA","avatar_url":"https://avatars.githubusercontent.com/in/1082092?v=4","gravatar_id":"","url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D","html_url":"https://github.com/apps/cubic-dev-ai","followers_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/followers","following_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/repos","events_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- metadata:{\"confidence\":8} -->\nP1: AnalyticsServiceMap entries are objects with a fetch() loader, but the new lazy-loading logic treats the entry itself as the module. This makes analyticsApp.default undefined and disables analytics services.\n\n<details>\n<summary>Prompt for AI agents</summary>\n\n```text\nCheck if this issue is valid ΓÇö if so, understand the root cause and fix it. At packages/app-store/_utils/getAnalytics.ts, line 26:\n\n<comment>AnalyticsServiceMap entries are objects with a fetch() loader, but the new lazy-loading logic treats the entry itself as the module. This makes analyticsApp.default undefined and disables analytics services.</comment>\n\n<file context>\n@@ -16,14 +16,16 @@ export const getAnalyticsService = async ({\n   }\n \n-  const analyticsApp = await analyticsAppImportFn;\n+  const analyticsApp = await (typeof analyticsAppGetter === \"function\"\n+    ? analyticsAppGetter()\n+    : analyticsAppGetter);\n</file context>\n```\n\n</details>\n\nΓ£à Addressed in [`603a4ff`](https://github.com/calcom/cal.com/commit/603a4ff0a353471efaacb0816c702a56e6ee798e)","created_at":"2026-01-22T18:27:23Z","updated_at":"2026-01-23T15:02:13Z","html_url":"https://github.com/calcom/cal.com/pull/27160#discussion_r2718097770","pull_request_url":"https://api.github.com/repos/calcom/cal.com/pulls/27160","_links":{"self":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097770"},"html":{"href":"https://github.com/calcom/cal.com/pull/27160#discussion_r2718097770"},"pull_request":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/27160"}},"reactions":{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":26,"original_line":26,"side":"RIGHT","author_association":"CONTRIBUTOR","original_position":14,"position":14,"subject_type":"line"},{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097774","pull_request_review_id":3693920404,"id":2718097774,"node_id":"PRRC_kwDOFOISeM6iAuFu","diff_hunk":"@@ -118,12 +118,15 @@ export async function createCRMEvent(payload: string): Promise<void> {\n \n     for (const appSlug of Object.keys(eventTypeAppMetadata)) {\n       const appData = eventTypeAppMetadata[appSlug as keyof typeof eventTypeAppMetadata];\n-      const appDataSchema = appDataSchemas[appSlug as keyof typeof appDataSchemas];\n-\n-      if (!appData || !appDataSchema) {\n-        throw new Error(`Could not find appData or appDataSchema for ${appSlug}`);\n+      \n+      const appDataSchemaFn = appDataSchemas[appSlug as keyof typeof appDataSchemas];\n+      \n+      if (!appData || !appDataSchemaFn) {\n+         throw new Error(`Could not find appData or appDataSchema for ${appSlug}`);\n       }\n \n+      const module = typeof appDataSchemaFn === \"function\" ? await appDataSchemaFn() : appDataSchemaFn;\n+      const appDataSchema = (module as any).default || (module as any).appDataSchema || module;","path":"packages/features/tasker/tasks/crm/createCRMEvent.ts","commit_id":"83b58b2a379325d838a5a4505e1c506b3ed36816","original_commit_id":"2f0d2afd01ea38b0a2ab110447002914bfb55832","user":{"login":"cubic-dev-ai[bot]","id":191113872,"node_id":"BOT_kgDOC2QqkA","avatar_url":"https://avatars.githubusercontent.com/in/1082092?v=4","gravatar_id":"","url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D","html_url":"https://github.com/apps/cubic-dev-ai","followers_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/followers","following_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/repos","events_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- metadata:{\"confidence\":8} -->\nP1: `appDataSchema` is a Zod schema instance, but the new extraction prioritizes `module.default`, which resolves to the schemaΓÇÖs `.default()` method and makes `safeParse` undefined, causing a runtime TypeError.\n\n<details>\n<summary>Prompt for AI agents</summary>\n\n```text\nCheck if this issue is valid ΓÇö if so, understand the root cause and fix it. At packages/features/tasker/tasks/crm/createCRMEvent.ts, line 129:\n\n<comment>`appDataSchema` is a Zod schema instance, but the new extraction prioritizes `module.default`, which resolves to the schemaΓÇÖs `.default()` method and makes `safeParse` undefined, causing a runtime TypeError.</comment>\n\n<file context>\n@@ -118,12 +118,15 @@ export async function createCRMEvent(payload: string): Promise<void> {\n       }\n \n+      const module = typeof appDataSchemaFn === \"function\" ? await appDataSchemaFn() : appDataSchemaFn;\n+      const appDataSchema = (module as any).default || (module as any).appDataSchema || module;\n       const appParse = appDataSchema.safeParse(appData);\n \n</file context>\n```\n\n</details>\n\nΓ£à Addressed in [`e903aaa`](https://github.com/calcom/cal.com/commit/e903aaa3e49ade0f213eed6571c7228cb5e7f18b)","created_at":"2026-01-22T18:27:23Z","updated_at":"2026-01-23T15:02:15Z","html_url":"https://github.com/calcom/cal.com/pull/27160#discussion_r2718097774","pull_request_url":"https://api.github.com/repos/calcom/cal.com/pulls/27160","_links":{"self":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097774"},"html":{"href":"https://github.com/calcom/cal.com/pull/27160#discussion_r2718097774"},"pull_request":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/27160"}},"reactions":{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":129,"original_line":129,"side":"RIGHT","author_association":"CONTRIBUTOR","original_position":16,"position":16,"subject_type":"line"},{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097779","pull_request_review_id":3693920404,"id":2718097779,"node_id":"PRRC_kwDOFOISeM6iAuFz","diff_hunk":"@@ -58,8 +58,11 @@ const handler = async (req: NextApiRequest, res: NextApiResponse) => {\n     /* Absolute path didn't work */\n     const handlerMap = (await import(\"@calcom/app-store/apps.server.generated\")).apiHandlers;\n     const handlerKey = deriveAppDictKeyFromType(appName, handlerMap);\n-    const handlers = await handlerMap[handlerKey as keyof typeof handlerMap];\n-    if (!handlers) throw new HttpError({ statusCode: 404, message: `No handlers found for ${handlerKey}` });\n+    const handlerGetter = handlerMap[handlerKey as keyof typeof handlerMap];\n+    if (!handlerGetter) throw new HttpError({ statusCode: 404, message: `No handlers found for ${handlerKey}` });\n+    const handlers = (await (typeof handlerGetter === \"function\"","path":"apps/web/pages/api/integrations/[...args].ts","commit_id":"83b58b2a379325d838a5a4505e1c506b3ed36816","original_commit_id":"2f0d2afd01ea38b0a2ab110447002914bfb55832","user":{"login":"cubic-dev-ai[bot]","id":191113872,"node_id":"BOT_kgDOC2QqkA","avatar_url":"https://avatars.githubusercontent.com/in/1082092?v=4","gravatar_id":"","url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D","html_url":"https://github.com/apps/cubic-dev-ai","followers_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/followers","following_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/repos","events_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/cubic-dev-ai%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- metadata:{\"confidence\":7} -->\nP2: handlerGetter returns a metadata object (with a fetch method), not the handlers record; this makes handlers[apiEndpoint] undefined and causes 404s for valid endpoints.\n\n<details>\n<summary>Prompt for AI agents</summary>\n\n```text\nCheck if this issue is valid ΓÇö if so, understand the root cause and fix it. At apps/web/pages/api/integrations/[...args].ts, line 63:\n\n<comment>handlerGetter returns a metadata object (with a fetch method), not the handlers record; this makes handlers[apiEndpoint] undefined and causes 404s for valid endpoints.</comment>\n\n<file context>\n@@ -58,8 +58,11 @@ const handler = async (req: NextApiRequest, res: NextApiResponse) => {\n-    if (!handlers) throw new HttpError({ statusCode: 404, message: `No handlers found for ${handlerKey}` });\n+    const handlerGetter = handlerMap[handlerKey as keyof typeof handlerMap];\n+    if (!handlerGetter) throw new HttpError({ statusCode: 404, message: `No handlers found for ${handlerKey}` });\n+    const handlers = (await (typeof handlerGetter === \"function\"\n+      ? handlerGetter()\n+      : handlerGetter)) as unknown as Record<string, AppHandler | AppDeclarativeHandler>;\n</file context>\n```\n\n</details>\n\nΓ£à Addressed in [`603a4ff`](https://github.com/calcom/cal.com/commit/603a4ff0a353471efaacb0816c702a56e6ee798e)","created_at":"2026-01-22T18:27:23Z","updated_at":"2026-01-23T15:02:15Z","html_url":"https://github.com/calcom/cal.com/pull/27160#discussion_r2718097779","pull_request_url":"https://api.github.com/repos/calcom/cal.com/pulls/27160","_links":{"self":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097779"},"html":{"href":"https://github.com/calcom/cal.com/pull/27160#discussion_r2718097779"},"pull_request":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/27160"}},"reactions":{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2718097779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":63,"original_line":63,"side":"RIGHT","author_association":"CONTRIBUTOR","original_position":8,"position":8,"subject_type":"line"},{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2721305927","pull_request_review_id":3697619001,"id":2721305927,"node_id":"PRRC_kwDOFOISeM6iM9VH","diff_hunk":"@@ -2,9 +2,10 @@\n     This file is autogenerated using the command `yarn app-store:build --watch`.\n     Don't modify this file manually.\n **/\n-export const AnalyticsServiceMap =\n-  process.env.NEXT_PUBLIC_IS_E2E === \"1\"\n-    ? {}\n-    : {\n-        dub: import(\"./dub/lib/AnalyticsService\"),\n-      };\n+export const AnalyticsServiceMap = process.env.NEXT_PUBLIC_IS_E2E === '1' ? {} : {","path":"packages/app-store/analytics.services.generated.ts","commit_id":"83b58b2a379325d838a5a4505e1c506b3ed36816","original_commit_id":"2f0d2afd01ea38b0a2ab110447002914bfb55832","user":{"login":"keithwillcode","id":2538462,"node_id":"MDQ6VXNlcjI1Mzg0NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2538462?v=4","gravatar_id":"","url":"https://api.github.com/users/keithwillcode","html_url":"https://github.com/keithwillcode","followers_url":"https://api.github.com/users/keithwillcode/followers","following_url":"https://api.github.com/users/keithwillcode/following{/other_user}","gists_url":"https://api.github.com/users/keithwillcode/gists{/gist_id}","starred_url":"https://api.github.com/users/keithwillcode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keithwillcode/subscriptions","organizations_url":"https://api.github.com/users/keithwillcode/orgs","repos_url":"https://api.github.com/users/keithwillcode/repos","events_url":"https://api.github.com/users/keithwillcode/events{/privacy}","received_events_url":"https://api.github.com/users/keithwillcode/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"The formatting is wrong for all of the generated files.","created_at":"2026-01-23T13:58:08Z","updated_at":"2026-01-23T14:00:02Z","html_url":"https://github.com/calcom/cal.com/pull/27160#discussion_r2721305927","pull_request_url":"https://api.github.com/repos/calcom/cal.com/pulls/27160","_links":{"self":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2721305927"},"html":{"href":"https://github.com/calcom/cal.com/pull/27160#discussion_r2721305927"},"pull_request":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/27160"}},"reactions":{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2721305927/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":5,"original_line":5,"side":"RIGHT","author_association":"CONTRIBUTOR","original_position":10,"position":10,"subject_type":"line"},{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2721366117","pull_request_review_id":3697711250,"id":2721366117,"node_id":"PRRC_kwDOFOISeM6iNMBl","diff_hunk":"@@ -2,9 +2,10 @@\n     This file is autogenerated using the command `yarn app-store:build --watch`.\n     Don't modify this file manually.\n **/\n-export const AnalyticsServiceMap =\n-  process.env.NEXT_PUBLIC_IS_E2E === \"1\"\n-    ? {}\n-    : {\n-        dub: import(\"./dub/lib/AnalyticsService\"),\n-      };\n+export const AnalyticsServiceMap = process.env.NEXT_PUBLIC_IS_E2E === '1' ? {} : {","path":"packages/app-store/analytics.services.generated.ts","commit_id":"83b58b2a379325d838a5a4505e1c506b3ed36816","original_commit_id":"2f0d2afd01ea38b0a2ab110447002914bfb55832","user":{"login":"Ashutosh0x","id":161562995,"node_id":"U_kgDOCaFBcw","avatar_url":"https://avatars.githubusercontent.com/u/161562995?v=4","gravatar_id":"","url":"https://api.github.com/users/Ashutosh0x","html_url":"https://github.com/Ashutosh0x","followers_url":"https://api.github.com/users/Ashutosh0x/followers","following_url":"https://api.github.com/users/Ashutosh0x/following{/other_user}","gists_url":"https://api.github.com/users/Ashutosh0x/gists{/gist_id}","starred_url":"https://api.github.com/users/Ashutosh0x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ashutosh0x/subscriptions","organizations_url":"https://api.github.com/users/Ashutosh0x/orgs","repos_url":"https://api.github.com/users/Ashutosh0x/repos","events_url":"https://api.github.com/users/Ashutosh0x/events{/privacy}","received_events_url":"https://api.github.com/users/Ashutosh0x/received_events","type":"User","user_view_type":"public","site_admin":false},"body":"let me fix these all","created_at":"2026-01-23T14:13:18Z","updated_at":"2026-01-23T14:13:18Z","html_url":"https://github.com/calcom/cal.com/pull/27160#discussion_r2721366117","pull_request_url":"https://api.github.com/repos/calcom/cal.com/pulls/27160","_links":{"self":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2721366117"},"html":{"href":"https://github.com/calcom/cal.com/pull/27160#discussion_r2721366117"},"pull_request":{"href":"https://api.github.com/repos/calcom/cal.com/pulls/27160"}},"reactions":{"url":"https://api.github.com/repos/calcom/cal.com/pulls/comments/2721366117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":5,"original_line":5,"side":"RIGHT","in_reply_to_id":2721305927,"author_association":"NONE","original_position":10,"position":10,"subject_type":"line"}]
